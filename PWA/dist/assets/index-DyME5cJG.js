import{r as m,j as e,c as ae,L as O,B as le,R as ce,a as W,b as de}from"./vendor-DTC6a9R3.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();let u,j=0,J=null;function q(){return(J===null||J.byteLength===0)&&(J=new Uint8Array(u.memory.buffer)),J}const K=new TextEncoder;"encodeInto"in K||(K.encodeInto=function(s,t){const r=K.encode(s);return t.set(r),{read:s.length,written:r.length}});function C(s,t,r){if(r===void 0){const c=K.encode(s),l=t(c.length,1)>>>0;return q().subarray(l,l+c.length).set(c),j=c.length,l}let a=s.length,n=t(a,1)>>>0;const o=q();let i=0;for(;i<a;i++){const c=s.charCodeAt(i);if(c>127)break;o[n+i]=c}if(i!==a){i!==0&&(s=s.slice(i)),n=r(n,a,a=i+s.length*3,1)>>>0;const c=q().subarray(n+i,n+a),l=K.encodeInto(s,c);i+=l.written,n=r(n,a,i,1)>>>0}return j=i,n}let B=null;function F(){return(B===null||B.buffer.detached===!0||B.buffer.detached===void 0&&B.buffer!==u.memory.buffer)&&(B=new DataView(u.memory.buffer)),B}function L(s){const t=u.__externref_table_alloc();return u.__wbindgen_export_4.set(t,s),t}function T(s,t){try{return s.apply(this,t)}catch(r){const a=L(r);u.__wbindgen_exn_store(a)}}let G=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});G.decode();const ge=2146435072;let H=0;function ue(s,t){return H+=t,H>=ge&&(G=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),G.decode(),H=t),G.decode(q().subarray(s,s+t))}function E(s,t){return s=s>>>0,ue(s,t)}function P(s){return s==null}function X(s,t){return s=s>>>0,q().subarray(s/1,s/1+t)}function I(s){const t=u.__wbindgen_export_4.get(s);return u.__externref_table_dealloc(s),t}function me(s,t){const r=t(s.length*4,4)>>>0;for(let a=0;a<s.length;a++){const n=L(s[a]);F().setUint32(r+4*a,n,!0)}return j=s.length,r}function xe(){const s=u.init_core();if(s[1])throw I(s[0])}const te=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(s=>u.__wbg_snartnetcore_free(s>>>0,1));let ee=class{__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,te.unregister(this),t}free(){const t=this.__destroy_into_raw();u.__wbg_snartnetcore_free(t,0)}constructor(){const t=u.snartnetcore_new();return this.__wbg_ptr=t>>>0,te.register(this,this.__wbg_ptr,this),this}init(){const t=u.snartnetcore_init(this.__wbg_ptr);if(t[1])throw I(t[0])}create_profile(t,r,a){let n,o;try{const b=C(t,u.__wbindgen_malloc,u.__wbindgen_realloc),p=j;var i=P(r)?0:C(r,u.__wbindgen_malloc,u.__wbindgen_realloc),c=j,l=P(a)?0:C(a,u.__wbindgen_malloc,u.__wbindgen_realloc),d=j;const h=u.snartnetcore_create_profile(this.__wbg_ptr,b,p,i,c,l,d);var x=h[0],g=h[1];if(h[3])throw x=0,g=0,I(h[2]);return n=x,o=g,E(x,g)}finally{u.__wbindgen_free(n,o,1)}}get_current_profile(){const t=u.snartnetcore_get_current_profile(this.__wbg_ptr);if(t[2])throw I(t[1]);return I(t[0])}update_current_profile(t,r){var a=P(t)?0:C(t,u.__wbindgen_malloc,u.__wbindgen_realloc),n=j,o=P(r)?0:C(r,u.__wbindgen_malloc,u.__wbindgen_realloc),i=j;const c=u.snartnetcore_update_current_profile(this.__wbg_ptr,a,n,o,i);if(c[1])throw I(c[0])}create_post(t,r,a){const n=C(t,u.__wbindgen_malloc,u.__wbindgen_realloc),o=j;var i=P(r)?0:me(r,u.__wbindgen_malloc),c=j,l=P(a)?0:C(a,u.__wbindgen_malloc,u.__wbindgen_realloc),d=j;const x=u.snartnetcore_create_post(this.__wbg_ptr,n,o,i,c,l,d);if(x[2])throw I(x[1]);return I(x[0])}create_message(t,r){const a=C(t,u.__wbindgen_malloc,u.__wbindgen_realloc),n=j,o=C(r,u.__wbindgen_malloc,u.__wbindgen_realloc),i=j,c=u.snartnetcore_create_message(this.__wbg_ptr,a,n,o,i);if(c[2])throw I(c[1]);return I(c[0])}get_public_key(){let t,r;try{const o=u.snartnetcore_get_public_key(this.__wbg_ptr);var a=o[0],n=o[1];if(o[3])throw a=0,n=0,I(o[2]);return t=a,r=n,E(a,n)}finally{u.__wbindgen_free(t,r,1)}}get_fingerprint(){let t,r;try{const o=u.snartnetcore_get_fingerprint(this.__wbg_ptr);var a=o[0],n=o[1];if(o[3])throw a=0,n=0,I(o[2]);return t=a,r=n,E(a,n)}finally{u.__wbindgen_free(t,r,1)}}has_profile(){return u.snartnetcore_has_profile(this.__wbg_ptr)!==0}};Symbol.dispose&&(ee.prototype[Symbol.dispose]=ee.prototype.free);const he=new Set(["basic","cors","default"]);async function fe(s,t){if(typeof Response=="function"&&s instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(s,t)}catch(a){if(s.ok&&he.has(s.type)&&s.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",a);else throw a}const r=await s.arrayBuffer();return await WebAssembly.instantiate(r,t)}else{const r=await WebAssembly.instantiate(s,t);return r instanceof WebAssembly.Instance?{instance:r,module:s}:r}}function be(){const s={};return s.wbg={},s.wbg.__wbg_String_8f0eb39a4a4c2f66=function(t,r){const a=String(r),n=C(a,u.__wbindgen_malloc,u.__wbindgen_realloc),o=j;F().setInt32(t+4*1,o,!0),F().setInt32(t+4*0,n,!0)},s.wbg.__wbg_call_13410aac570ffff7=function(){return T(function(t,r){return t.call(r)},arguments)},s.wbg.__wbg_call_a5400b25a865cfd8=function(){return T(function(t,r,a){return t.call(r,a)},arguments)},s.wbg.__wbg_crypto_574e78ad8b13b65f=function(t){return t.crypto},s.wbg.__wbg_error_7534b8e9a36f1ab4=function(t,r){let a,n;try{a=t,n=r,console.error(E(t,r))}finally{u.__wbindgen_free(a,n,1)}},s.wbg.__wbg_getItem_9fc74b31b896f95a=function(){return T(function(t,r,a,n){const o=r.getItem(E(a,n));var i=P(o)?0:C(o,u.__wbindgen_malloc,u.__wbindgen_realloc),c=j;F().setInt32(t+4*1,c,!0),F().setInt32(t+4*0,i,!0)},arguments)},s.wbg.__wbg_getRandomValues_38a1ff1ea09f6cc7=function(){return T(function(t,r){globalThis.crypto.getRandomValues(X(t,r))},arguments)},s.wbg.__wbg_getRandomValues_b8f5dbd5f3995a9e=function(){return T(function(t,r){t.getRandomValues(r)},arguments)},s.wbg.__wbg_getTime_6bb3f64e0f18f817=function(t){return t.getTime()},s.wbg.__wbg_instanceof_Window_12d20d558ef92592=function(t){let r;try{r=t instanceof Window}catch{r=!1}return r},s.wbg.__wbg_length_6bb7e81f9d7713e4=function(t){return t.length},s.wbg.__wbg_localStorage_9330af8bf39365ba=function(){return T(function(t){const r=t.localStorage;return P(r)?0:L(r)},arguments)},s.wbg.__wbg_log_6c7b5f4f00b8ce3f=function(t){console.log(t)},s.wbg.__wbg_msCrypto_a61aeb35a24c1329=function(t){return t.msCrypto},s.wbg.__wbg_new0_b0a0a38c201e6df5=function(){return new Date},s.wbg.__wbg_new_19c25a3f2fa63a02=function(){return new Object},s.wbg.__wbg_new_1f3a344cf3123716=function(){return new Array},s.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},s.wbg.__wbg_newnoargs_254190557c45b4ec=function(t,r){return new Function(E(t,r))},s.wbg.__wbg_newwithlength_a167dcc7aaa3ba77=function(t){return new Uint8Array(t>>>0)},s.wbg.__wbg_node_905d3e251edff8a2=function(t){return t.node},s.wbg.__wbg_process_dc0fbacc7c1c06f7=function(t){return t.process},s.wbg.__wbg_prototypesetcall_3d4a26c1ed734349=function(t,r,a){Uint8Array.prototype.set.call(X(t,r),a)},s.wbg.__wbg_randomFillSync_ac0988aba3254290=function(){return T(function(t,r){t.randomFillSync(r)},arguments)},s.wbg.__wbg_removeItem_487c5a070c7adaf7=function(){return T(function(t,r,a){t.removeItem(E(r,a))},arguments)},s.wbg.__wbg_require_60cc747a6bc5215a=function(){return T(function(){return module.require},arguments)},s.wbg.__wbg_setItem_7add5eb06a28b38f=function(){return T(function(t,r,a,n,o){t.setItem(E(r,a),E(n,o))},arguments)},s.wbg.__wbg_set_3f1d0b984ed272ed=function(t,r,a){t[r]=a},s.wbg.__wbg_set_90f6c0f7bd8c0415=function(t,r,a){t[r>>>0]=a},s.wbg.__wbg_stack_0ed75d68575b0f3c=function(t,r){const a=r.stack,n=C(a,u.__wbindgen_malloc,u.__wbindgen_realloc),o=j;F().setInt32(t+4*1,o,!0),F().setInt32(t+4*0,n,!0)},s.wbg.__wbg_static_accessor_GLOBAL_8921f820c2ce3f12=function(){const t=typeof globalThis>"u"?null:globalThis;return P(t)?0:L(t)},s.wbg.__wbg_static_accessor_GLOBAL_THIS_f0a4409105898184=function(){const t=typeof globalThis>"u"?null:globalThis;return P(t)?0:L(t)},s.wbg.__wbg_static_accessor_SELF_995b214ae681ff99=function(){const t=typeof self>"u"?null:self;return P(t)?0:L(t)},s.wbg.__wbg_static_accessor_WINDOW_cde3890479c675ea=function(){const t=typeof window>"u"?null:window;return P(t)?0:L(t)},s.wbg.__wbg_subarray_70fd07feefe14294=function(t,r,a){return t.subarray(r>>>0,a>>>0)},s.wbg.__wbg_versions_c01dfd4722a88165=function(t){return t.versions},s.wbg.__wbg_wbindgenisfunction_8cee7dce3725ae74=function(t){return typeof t=="function"},s.wbg.__wbg_wbindgenisobject_307a53c6bd97fbf8=function(t){const r=t;return typeof r=="object"&&r!==null},s.wbg.__wbg_wbindgenisstring_d4fa939789f003b0=function(t){return typeof t=="string"},s.wbg.__wbg_wbindgenisundefined_c4b71d073b92f3c5=function(t){return t===void 0},s.wbg.__wbg_wbindgenstringget_0f16a6ddddef376f=function(t,r){const a=r,n=typeof a=="string"?a:void 0;var o=P(n)?0:C(n,u.__wbindgen_malloc,u.__wbindgen_realloc),i=j;F().setInt32(t+4*1,i,!0),F().setInt32(t+4*0,o,!0)},s.wbg.__wbg_wbindgenthrow_451ec1a8469d7eb6=function(t,r){throw new Error(E(t,r))},s.wbg.__wbindgen_cast_2241b6af4c4b2941=function(t,r){return E(t,r)},s.wbg.__wbindgen_cast_cb9088102bce6b30=function(t,r){return X(t,r)},s.wbg.__wbindgen_cast_d6cd19b81560fd6e=function(t){return t},s.wbg.__wbindgen_init_externref_table=function(){const t=u.__wbindgen_export_4,r=t.grow(4);t.set(0,void 0),t.set(r+0,void 0),t.set(r+1,null),t.set(r+2,!0),t.set(r+3,!1)},s}function pe(s,t){return u=s.exports,se.__wbindgen_wasm_module=t,B=null,J=null,u.__wbindgen_start(),u}async function se(s){if(u!==void 0)return u;typeof s<"u"&&(Object.getPrototypeOf(s)===Object.prototype?{module_or_path:s}=s:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof s>"u"&&(s=new URL("/net/assets/snartnet_core_bg-CgG932GT.wasm",import.meta.url));const t=be();(typeof s=="string"||typeof Request=="function"&&s instanceof Request||typeof URL=="function"&&s instanceof URL)&&(s=fetch(s));const{instance:r,module:a}=await fe(await s,t);return pe(r,a)}class ye{client=null;activeTorrents=new Map;eventCallbacks=[];stats={torrents:0,downloadSpeed:0,uploadSpeed:0,downloaded:0,uploaded:0,peers:0};constructor(){this.initializeClient()}async initializeClient(){if(!(typeof window>"u"))try{const t=window.WebTorrent;if(!t||typeof t!="function")throw new Error("WebTorrent not available - please ensure CDN is loaded");this.client=new t,this.client.on("error",r=>{this.emitEvent({type:"error",error:r.message})}),this.client.on("torrent",r=>{this.activeTorrents.set(r.infoHash,r),this.emitEvent({type:"torrent-added",torrent:r}),this.updateStats()}),console.log("WebTorrent client initialized successfully")}catch(t){console.error("Failed to initialize WebTorrent:",t),this.emitEvent({type:"error",error:`Failed to initialize WebTorrent: ${t}`})}}emitEvent(t){this.eventCallbacks.forEach(r=>{try{r(t)}catch(a){console.error("Error in event callback:",a)}})}updateStats(){if(this.client)try{this.stats={torrents:this.client.torrents.length,downloadSpeed:this.client.downloadSpeed||0,uploadSpeed:this.client.uploadSpeed||0,downloaded:this.client.downloaded||0,uploaded:this.client.uploaded||0,peers:this.client.torrents.reduce((t,r)=>t+(r.numPeers||0),0)}}catch(t){console.error("Error updating stats:",t)}}async seedProfile(t){if(!this.client)throw new Error("WebTorrent client not initialized. Are you in a browser environment?");try{const r=JSON.stringify(t,null,2),a=`${t.username}_profile.json`,o=new TextEncoder().encode(r),i=new File([o],a,{type:"application/json; charset=utf-8"});return new Promise((c,l)=>{const d=setTimeout(()=>{l(new Error("Seeding timeout"))},1e4);try{console.log("Seeding profile file:",{fileName:a,fileSize:i.size,fileType:i.type,profileDataLength:r.length});const x=this.client.seed([i],g=>{clearTimeout(d),console.log("Profile seeded successfully:",g.magnetURI),this.emitEvent({type:"seeding-started",profile:t,magnetURI:g.magnetURI}),c(g.magnetURI)});x.on("error",g=>{clearTimeout(d),this.emitEvent({type:"error",error:g.message}),l(g)}),x.on("wire",g=>{this.emitEvent({type:"peer-connected",peerId:g.peerId||"unknown"})}),x.on("upload",()=>{this.emitEvent({type:"upload-progress",uploadSpeed:x.uploadSpeed||0}),this.updateStats()})}catch(x){clearTimeout(d),l(x)}})}catch(r){throw console.error("Error seeding profile:",r),r}}async downloadProfile(t){if(!this.client)throw new Error("WebTorrent client not initialized. Are you in a browser environment?");try{return new Promise((r,a)=>{const n=setTimeout(()=>{a(new Error("Download timeout - no peers found"))},3e4);try{const o=this.client.add(t,i=>{console.log("Started downloading torrent:",i.name||"unnamed")});o.on("done",()=>{clearTimeout(n);const i=o.files.find(c=>c.name&&c.name.endsWith("_profile.json"));if(i)i.getBuffer((c,l)=>{if(c){this.emitEvent({type:"error",error:c.message}),a(c);return}try{let d;if(l instanceof ArrayBuffer){const g=new Uint8Array(l);d=new TextDecoder("utf-8",{fatal:!1}).decode(g)}else l&&typeof l.toString=="function"?d=l.toString("utf8"):d=String(l);const x=JSON.parse(d);this.emitEvent({type:"profile-downloaded",profile:x}),r(x)}catch(d){console.error("Profile parsing error:",d),console.error("Buffer type:",typeof l),console.error("Buffer constructor:",l?.constructor?.name),this.emitEvent({type:"error",error:`Failed to parse profile data: ${d instanceof Error?d.message:"Unknown error"}`}),a(d)}});else{const c="Profile file not found in torrent";this.emitEvent({type:"error",error:c}),a(new Error(c))}}),o.on("download",()=>{this.emitEvent({type:"download-progress",progress:o.progress||0,downloadSpeed:o.downloadSpeed||0}),this.updateStats()}),o.on("error",i=>{clearTimeout(n),this.emitEvent({type:"error",error:i.message}),a(i)})}catch(o){clearTimeout(n),a(o)}})}catch(r){throw console.error("Error downloading profile:",r),r}}getStats(){return this.updateStats(),{...this.stats}}getActiveTorrents(){if(!this.client)return[];try{return this.client.torrents.map(t=>({infoHash:t.infoHash||"",name:t.name||"Unnamed Torrent",magnetURI:t.magnetURI||"",progress:t.progress||0,downloadSpeed:t.downloadSpeed||0,uploadSpeed:t.uploadSpeed||0,numPeers:t.numPeers||0,downloaded:t.downloaded||0,uploaded:t.uploaded||0}))}catch(t){return console.error("Error getting active torrents:",t),[]}}onEvent(t){return this.eventCallbacks.push(t),()=>{const r=this.eventCallbacks.indexOf(t);r>-1&&this.eventCallbacks.splice(r,1)}}stopSeeding(t){if(!this.client)return!1;try{const r=this.client.get(t);return r?(this.client.remove(r),this.activeTorrents.delete(t),this.updateStats(),!0):!1}catch(r){return console.error("Error stopping torrent seeding:",r),!1}}destroy(){try{this.client&&typeof this.client.destroy=="function"&&this.client.destroy()}catch(t){console.error("Error destroying torrent client:",t)}}}let Z=null;function $(){return Z||(Z=new ye),Z}class we{wasmCore;eventCallbacks=new Set;constructor(t){this.wasmCore=t}async init(){try{await this.wasmCore.init(),console.log("[SnartNetCore] WASM core initialized")}catch(t){throw console.error("[SnartNetCore] Init error:",t),t}}async createProfile(t,r,a){try{const n=this.wasmCore.create_profile(t,r||null,a||null);console.log("[SnartNetCore] Profile created:",{username:t,magnetUri:n});const o=this.wasmCore.get_current_profile();return o&&this.emitEvent({type:"ProfileLoaded",profile:o}),n}catch(n){throw console.error("[SnartNetCore] Create profile error:",n),n}}async getCurrentProfile(){try{return this.wasmCore.get_current_profile()}catch(t){return console.error("[SnartNetCore] Get profile error:",t),null}}async updateProfile(t,r){try{await this.wasmCore.update_current_profile(t||null,r||null);const a=this.wasmCore.get_current_profile();a&&this.emitEvent({type:"ProfileUpdated",profile:a})}catch(a){throw console.error("[SnartNetCore] Update profile error:",a),a}}async getPublicKey(){try{return this.wasmCore.get_public_key()}catch(t){throw console.error("[SnartNetCore] Get public key error:",t),t}}async getFingerprint(){try{return this.wasmCore.get_fingerprint()}catch(t){throw console.error("[SnartNetCore] Get fingerprint error:",t),t}}async createPost(t,r,a){try{const n=this.wasmCore.create_post(t,r||null,a||null);return console.log("[SnartNetCore] Post created:",n),this.emitEvent({type:"PostAdded",post:n}),n}catch(n){throw console.error("[SnartNetCore] Create post error:",n),n}}async createMessage(t,r){try{const a=this.wasmCore.create_message(t,r);return console.log("[SnartNetCore] Message created:",a),this.emitEvent({type:"MessageReceived",message:a}),a}catch(a){throw console.error("[SnartNetCore] Create message error:",a),a}}hasProfile(){return this.wasmCore.has_profile()}subscribeToEvents(t){return this.eventCallbacks.add(t),()=>this.eventCallbacks.delete(t)}emitEvent(t){this.eventCallbacks.forEach(r=>{try{r(t)}catch(a){console.error("[SnartNetCore] Error in event callback:",a)}})}async seedCurrentProfile(){try{const t=this.wasmCore.get_current_profile();if(!t)throw new Error("No current profile to seed");console.log("[SnartNetCore] Profile data type:",typeof t),console.log("[SnartNetCore] Profile data:",t);let r;typeof t=="object"&&t!==null?r=JSON.parse(JSON.stringify(t)):r=t,console.log("[SnartNetCore] Clean profile:",r);const n=await $().seedProfile(r);return console.log("[SnartNetCore] Profile seeding started:",n),n}catch(t){throw console.error("[SnartNetCore] Failed to seed profile:",t),t}}async downloadProfileFromMagnet(t){try{const a=await $().downloadProfile(t);return console.log("[SnartNetCore] Profile downloaded:",a),a}catch(r){throw console.error("[SnartNetCore] Failed to download profile:",r),r}}getTorrentStats(){return $().getStats()}getActiveTorrents(){return $().getActiveTorrents()}async stopSeeding(t){$().stopSeeding(t)}async getTimeline(){return[{id:"post_1",content:"Welcome to SnartNet! This is a decentralized social media platform.",author:"alice",timestamp:new Date(Date.now()-36e5).toISOString(),tags:["introduction","snartnet"]},{id:"post_2",content:"Just created my first cryptographically signed post! üîê",author:"bob",timestamp:new Date(Date.now()-18e5).toISOString(),tags:["crypto","security"]}]}}let Y=null;async function z(){if(!Y)try{await se(),await xe();const s=new ee;Y=new we(s),await Y.init(),console.log("[Core] Initialized successfully")}catch(s){throw console.error("[Core] Initialization failed:",s),s}return Y}function ve(){const[s,t]=m.useState(null),[r,a]=m.useState(!0);return m.useEffect(()=>{z().then(n=>{t(n),a(!1)}).catch(n=>{console.error("Failed to initialize core:",n),a(!1)})},[]),{core:s,loading:r}}const ke=()=>{const{core:s,loading:t}=ve(),[r,a]=m.useState([]),[n,o]=m.useState(!0);return m.useEffect(()=>{s&&s.getTimeline().then(i=>{a(i),o(!1)})},[s]),t||n?e.jsx("div",{className:"flex items-center justify-center min-h-64",children:e.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:"Loading SnartNet..."})}):e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"SnartNet"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-8",children:"Decentralized social media, powered by swarms."}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Timeline"}),e.jsx("div",{className:"space-y-4",children:r.map(i=>e.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700 pb-4 last:border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:["@",i.author]}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(i.timestamp).toLocaleString()})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-2",children:i.content}),i.tags&&i.tags.length>0&&e.jsx("div",{className:"flex gap-2",children:i.tags.map(c=>e.jsxs("span",{className:"text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded",children:["#",c]},c))})]},i.id))})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Getting Started"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Welcome to SnartNet! This is a decentralized social media platform built on BitTorrent-like swarm technology and modern cryptography."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"üîê Your identity is cryptographically secured"}),e.jsx("p",{className:"text-sm text-gray-500",children:"üåê Content is distributed peer-to-peer"}),e.jsx("p",{className:"text-sm text-gray-500",children:"ü§ù Trust is managed through your Ring of Trust"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Development Status"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),e.jsx("span",{children:"React PWA setup complete"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),e.jsx("span",{children:"Mock core interface active"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full mr-2"}),e.jsx("span",{children:"Rust WASM core (planned)"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full mr-2"}),e.jsx("span",{children:"P2P networking (future)"})]})]})]})]})]})]})},D=ae(s=>({currentProfile:null,profiles:new Map,loading:!1,error:null,setCurrentProfile:t=>s({currentProfile:t}),addProfile:t=>s(r=>{const a=new Map(r.profiles);return a.set(t.username,t),{profiles:a}}),updateProfile:(t,r)=>s(a=>{const n=new Map(a.profiles),o=n.get(t);o&&n.set(t,{...o,...r});let i=a.currentProfile;return a.currentProfile?.username===t&&(i={...a.currentProfile,...r}),{profiles:n,currentProfile:i}}),updateProfilePicture:(t,r,a)=>s(n=>{const o={profilePicture:r,profilePictureThumbnail:a||r,updatedAt:new Date().toISOString()},i=new Map(n.profiles),c=i.get(t);c&&i.set(t,{...c,...o});let l=n.currentProfile;return n.currentProfile?.username===t&&(l={...n.currentProfile,...o},localStorage.setItem(`profile-picture-${t}`,r),a&&localStorage.setItem(`profile-picture-thumb-${t}`,a)),{profiles:i,currentProfile:l}}),addProfilePost:(t,r)=>s(a=>{const n=new Map(a.profiles),o=n.get(t),i={id:Math.random().toString(36).slice(2),content:r,createdAt:new Date().toISOString()};if(o){const l=o.posts?[i,...o.posts]:[i];n.set(t,{...o,posts:l})}let c=a.currentProfile;if(a.currentProfile?.username===t){const l=a.currentProfile.posts?[i,...a.currentProfile.posts]:[i];c={...a.currentProfile,posts:l}}return{profiles:n,currentProfile:c}}),removeProfilePost:(t,r)=>s(a=>{const n=new Map(a.profiles),o=n.get(t);if(o&&o.posts){const c=o.posts.filter(l=>l.id!==r);n.set(t,{...o,posts:c})}let i=a.currentProfile;if(a.currentProfile?.username===t&&a.currentProfile.posts){const c=a.currentProfile.posts.filter(l=>l.id!==r);i={...a.currentProfile,posts:c}}return{profiles:n,currentProfile:i}}),setLoading:t=>s({loading:t}),setError:t=>s({error:t}),clearError:()=>s({error:null})}));function re(){const[s,t]=m.useState(""),[r,a]=m.useState(""),[n,o]=m.useState(""),[i,c]=m.useState(!1),[l,d]=m.useState(null),[x,g]=m.useState(null),{setCurrentProfile:b,setLoading:p,setError:h}=D(),y=async f=>{if(f.preventDefault(),!s.trim()){d("Username is required");return}c(!0),d(null),g(null),h(null),p(!0);try{console.log("[CreateProfile] Starting profile creation...");const _=await z();console.log("[CreateProfile] Core initialized");const w=await _.createProfile(s.trim(),r.trim()||void 0,n.trim()||void 0);console.log("[CreateProfile] Profile created with magnet URI:",w);const S=await _.getCurrentProfile();if(console.log("[CreateProfile] Retrieved profile:",S),S)b(S),g(`Profile created successfully! Magnet URI: ${w}`),t(""),a(""),o(""),console.log("[CreateProfile] Profile creation completed successfully");else throw new Error("Failed to retrieve created profile")}catch(_){console.error("[CreateProfile] Error creating profile:",_);const w=_ instanceof Error?_.message:"Failed to create profile";d(w),h(w)}finally{c(!1),p(!1)}};return e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Create Your Profile"}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Username *"}),e.jsx("input",{type:"text",id:"username",value:s,onChange:f=>t(f.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your username",disabled:i,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"displayName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Display Name"}),e.jsx("input",{type:"text",id:"displayName",value:r,onChange:f=>a(f.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Your display name (optional)",disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Bio"}),e.jsx("textarea",{id:"bio",value:n,onChange:f=>o(f.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Tell us about yourself (optional)",disabled:i})]}),l&&e.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:l})}),x&&e.jsx("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md",children:e.jsx("p",{className:"text-green-700 dark:text-green-300 text-sm",children:x})}),e.jsx("button",{type:"submit",disabled:i||!s.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:cursor-not-allowed",children:i?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating Profile..."]}):"Create Profile"})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"üîê What happens when you create a profile?"}),e.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ A new Ed25519 cryptographic key pair is generated"}),e.jsx("li",{children:"‚Ä¢ Your profile is signed with your private key"}),e.jsx("li",{children:"‚Ä¢ A magnet URI is created for peer-to-peer sharing"}),e.jsx("li",{children:"‚Ä¢ Your private keys stay in your browser (never uploaded)"})]})]})]})})}class R{static PROFILE_SIZE=200;static THUMBNAIL_SIZE=64;static MAX_FILE_SIZE=2*1024*1024;static SUPPORTED_FORMATS=["image/jpeg","image/png","image/webp"];static OUTPUT_FORMAT="image/jpeg";static OUTPUT_QUALITY=.85;static async processProfilePicture(t){this.validateFile(t);const r=await this.loadImage(t),a=this.calculateSquareCrop(r.width,r.height);return await this.resizeAndCompress(r,a,this.PROFILE_SIZE)}static async createThumbnail(t){const r=await this.loadImageFromDataUrl(t.dataUrl),a={x:0,y:0,width:r.width,height:r.height};return this.resizeAndCompress(r,a,this.THUMBNAIL_SIZE)}static async processWithCrop(t,r){this.validateFile(t);const a=await this.loadImage(t);return this.resizeAndCompress(a,r,this.PROFILE_SIZE)}static validateFile(t){if(!this.SUPPORTED_FORMATS.includes(t.type))throw new Error(`Unsupported file format. Please use: ${this.SUPPORTED_FORMATS.join(", ")}`);if(t.size>this.MAX_FILE_SIZE)throw new Error(`File too large. Maximum size: ${Math.round(this.MAX_FILE_SIZE/1024/1024)}MB`)}static loadImage(t){return new Promise((r,a)=>{const n=new Image,o=URL.createObjectURL(t);n.onload=()=>{URL.revokeObjectURL(o),r(n)},n.onerror=()=>{URL.revokeObjectURL(o),a(new Error("Failed to load image"))},n.src=o})}static loadImageFromDataUrl(t){return new Promise((r,a)=>{const n=new Image;n.onload=()=>r(n),n.onerror=()=>a(new Error("Failed to load image from data URL")),n.src=t})}static calculateSquareCrop(t,r){const a=Math.min(t,r),n=(t-a)/2,o=(r-a)/2;return{x:n,y:o,width:a,height:a}}static async resizeAndCompress(t,r,a){const n=document.createElement("canvas"),o=n.getContext("2d");if(!o)throw new Error("Canvas context not available");n.width=a,n.height=a,o.imageSmoothingEnabled=!0,o.imageSmoothingQuality="high",o.drawImage(t,r.x,r.y,r.width,r.height,0,0,a,a);const i=await new Promise((l,d)=>{n.toBlob(x=>{x?l(x):d(new Error("Failed to create blob"))},this.OUTPUT_FORMAT,this.OUTPUT_QUALITY)});return{dataUrl:n.toDataURL(this.OUTPUT_FORMAT,this.OUTPUT_QUALITY),blob:i,width:a,height:a,size:i.size,format:this.OUTPUT_FORMAT}}static async blobToBase64(t){return new Promise((r,a)=>{const n=new FileReader;n.onload=()=>{const i=n.result.split(",")[1];r(i)},n.onerror=()=>a(new Error("Failed to convert blob to base64")),n.readAsDataURL(t)})}static base64ToDataUrl(t,r=this.OUTPUT_FORMAT){return`data:${r};base64,${t}`}static formatFileSize(t){if(t===0)return"0 B";const r=1024,a=["B","KB","MB"],n=Math.floor(Math.log(t)/Math.log(r));return parseFloat((t/Math.pow(r,n)).toFixed(1))+" "+a[n]}static validateImageDimensions(t,r){if(t<100||r<100)throw new Error("Image too small. Minimum size: 100x100px");if(t>4e3||r>4e3)throw new Error("Image too large. Maximum size: 4000x4000px")}static generateAvatarInitials(t){return t.split(" ").map(r=>r.charAt(0).toUpperCase()).join("").substring(0,2)}static generateAvatarGradient(t){let r=0;for(let o=0;o<t.length;o++){const i=t.charCodeAt(o);r=(r<<5)-r+i,r=r&r}const a=Math.abs(r%360),n=(a+60)%360;return`linear-gradient(135deg, hsl(${a}, 70%, 50%), hsl(${n}, 70%, 70%))`}}const je=({profilePicture:s,username:t="User",size:r="md",className:a="",showOnlineStatus:n=!1,isOnline:o=!1,alt:i})=>{const c={xs:"w-6 h-6",sm:"w-8 h-8",md:"w-12 h-12",lg:"w-16 h-16",xl:"w-24 h-24"},l={xs:"w-1.5 h-1.5 bottom-0 right-0",sm:"w-2 h-2 bottom-0 right-0",md:"w-3 h-3 bottom-0.5 right-0.5",lg:"w-4 h-4 bottom-1 right-1",xl:"w-6 h-6 bottom-1 right-1"},d=g=>g.split(" ").map(b=>b.charAt(0).toUpperCase()).slice(0,2).join(""),x=s?e.jsx("img",{src:R.base64ToDataUrl(s),alt:i||`${t}'s avatar`,className:`${c[r]} rounded-full object-cover ${a}`}):e.jsx("div",{className:`${c[r]} rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-semibold ${a}`,title:t,children:e.jsx("span",{className:`${r==="xs"?"text-xs":r==="sm"?"text-sm":r==="md"?"text-base":r==="lg"?"text-lg":"text-xl"}`,children:d(t)})});return e.jsxs("div",{className:"relative inline-block",children:[x,n&&e.jsx("div",{className:`absolute ${l[r]} ${o?"bg-green-400":"bg-gray-400"} border-2 border-white dark:border-gray-800 rounded-full`})]})},_e=({onClose:s,onSuccess:t})=>{const{currentProfile:r,updateProfilePicture:a}=D(),n=m.useRef(null),[o,i]=m.useState(!1),[c,l]=m.useState(!1),[d,x]=m.useState(null),[g,b]=m.useState(null),[p,h]=m.useState(""),[y,f]=m.useState(0),_=()=>{x(null),b(null),h(""),f(0),n.current&&(n.current.value="")},w=m.useCallback(async k=>{const U=k[0];if(U)try{l(!0),h("üì§ Processing image..."),f(25);const N=await R.processProfilePicture(U);f(75),await R.createThumbnail(N),f(90),b(N),x(N.dataUrl),h(`‚úÖ Image processed successfully! Size: ${R.formatFileSize(N.size)}`),f(100),console.log("Image processed:",{originalSize:U.size,processedSize:N.size,dimensions:`${N.width}x${N.height}`,format:N.format})}catch(N){console.error("Image processing error:",N),h(`‚ùå Error: ${N instanceof Error?N.message:"Unknown error"}`),_()}finally{l(!1)}},[]),S=k=>{const U=k.target.files;U&&U.length>0&&w(U)},V=m.useCallback(k=>{k.preventDefault(),k.stopPropagation(),i(!1),k.dataTransfer.files&&k.dataTransfer.files.length>0&&w(k.dataTransfer.files)},[w]),v=m.useCallback(k=>{k.preventDefault(),k.stopPropagation(),k.type==="dragenter"||k.type==="dragover"?i(!0):k.type==="dragleave"&&i(!1)},[]),A=async()=>{if(!g||!r){h("‚ùå No image to save or no current profile");return}try{l(!0),h("üíæ Saving profile picture...");const k=await R.blobToBase64(g.blob),U=await R.createThumbnail(g),N=await R.blobToBase64(U.blob);a(r.username,k,N),h("‚úÖ Profile picture saved successfully!"),t&&t(g.dataUrl),setTimeout(()=>{s&&s()},1500)}catch(k){console.error("Save error:",k),h(`‚ùå Failed to save: ${k instanceof Error?k.message:"Unknown error"}`)}finally{l(!1)}},M=()=>{r&&confirm("Remove your profile picture?")&&(a(r.username,"",""),localStorage.removeItem(`profile-picture-${r.username}`),localStorage.removeItem(`profile-picture-thumb-${r.username}`),h("‚úÖ Profile picture removed"),t&&t(""),setTimeout(()=>{s&&s()},1e3))},ie=()=>y>=100?"w-full":y>=90?"w-11/12":y>=75?"w-3/4":y>=50?"w-1/2":y>=25?"w-1/4":"w-0";return e.jsxs("div",{className:"max-w-md mx-auto p-6 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Profile Picture"}),s&&e.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:"‚úï"})]}),!d&&e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${o?"border-blue-400 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`,onDragEnter:v,onDragLeave:v,onDragOver:v,onDrop:V,children:[e.jsx("div",{className:"text-4xl mb-4",children:"üì∑"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Drag and drop an image here, or click to select"}),e.jsx("button",{onClick:()=>n.current?.click(),disabled:c,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg transition-colors",children:"Choose Image"}),e.jsx("input",{ref:n,type:"file",accept:"image/*",onChange:S,className:"hidden","aria-label":"Select profile picture file",title:"Select profile picture file"}),e.jsxs("div",{className:"mt-4 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("p",{children:"Supported: JPEG, PNG, WebP"}),e.jsx("p",{children:"Max size: 2MB ‚Ä¢ Auto-cropped to square"})]})]}),d&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:d,alt:"Profile preview",className:"w-32 h-32 rounded-full object-cover border-4 border-gray-200 dark:border-gray-600"}),c&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})})]})}),g&&e.jsxs("div",{className:"text-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("p",{children:["Size: ",R.formatFileSize(g.size)]}),e.jsxs("p",{children:["Dimensions: ",g.width,"√ó",g.height,"px"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:A,disabled:c||!g,className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white rounded-lg transition-colors",children:c?"üíæ Saving...":"üíæ Save"}),e.jsx("button",{onClick:_,disabled:c,className:"px-4 py-2 bg-gray-500 hover:bg-gray-600 disabled:bg-gray-400 text-white rounded-lg transition-colors",children:"üîÑ Try Again"})]})]}),c&&y>0&&e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:`bg-blue-600 h-2 rounded-full transition-all duration-300 ${ie()}`})})}),r?.profilePicture&&!d&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("img",{src:R.base64ToDataUrl(r.profilePicture),alt:"Current profile",className:"w-16 h-16 rounded-full object-cover border-2 border-gray-200 dark:border-gray-600"})}),e.jsx("button",{onClick:M,className:"w-full px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"üóëÔ∏è Remove Current Picture"})]}),p&&e.jsx("div",{className:`mt-4 p-3 rounded-lg text-sm ${p.startsWith("‚úÖ")?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-200":p.startsWith("‚ùå")?"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-200":"bg-blue-50 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200"}`,children:p})]})},Ne=()=>{const{currentProfile:s,addProfilePost:t,removeProfilePost:r}=D(),[a,n]=m.useState(""),[o,i]=m.useState(!1);if(!s)return null;const c=async l=>{l.preventDefault(),a.trim()&&(i(!0),t(s.username,a.trim()),n(""),i(!1))};return e.jsxs("div",{className:"w-full max-w-xl mx-auto mt-8",children:[e.jsxs("form",{onSubmit:c,className:"mb-6 flex flex-col gap-2",children:[e.jsx("textarea",{className:"w-full p-3 border border-gray-300 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white resize-vertical",rows:3,placeholder:"What's on your mind?",value:a,onChange:l=>n(l.target.value),disabled:o}),e.jsx("button",{type:"submit",className:"self-end px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg disabled:bg-gray-400",disabled:o||!a.trim(),children:o?"Posting...":"Post"})]}),e.jsx("div",{className:"space-y-4",children:s.posts&&s.posts.length>0?s.posts.map(l=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 relative",children:[e.jsx("p",{className:"text-gray-900 dark:text-gray-100 mb-2 whitespace-pre-line",children:l.content}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 flex justify-between items-center",children:[e.jsx("span",{children:new Date(l.createdAt).toLocaleString()}),e.jsx("button",{className:"text-red-500 hover:text-red-700 text-xs ml-2",onClick:()=>r(s.username,l.id),title:"Delete post",children:"üóëÔ∏è"})]})]},l.id)):e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400",children:"No posts yet."})})]})},Se=()=>{const{currentProfile:s}=D(),[t,r]=m.useState(!1);return s?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 flex flex-col items-center",children:[e.jsxs("div",{className:"mb-4 relative",children:[e.jsx(je,{profilePicture:s.profilePicture,username:s.username,size:"xl"}),e.jsx("button",{className:"absolute bottom-0 right-0 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-2 shadow-lg border-2 border-white dark:border-gray-800",onClick:()=>r(!0),title:"Change profile picture",children:e.jsx("span",{role:"img","aria-label":"Edit",children:"‚úèÔ∏è"})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:s.displayName||s.username}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-300 mb-2",children:["@",s.username]}),s.bio&&e.jsx("p",{className:"text-gray-700 dark:text-gray-200 mb-2 max-w-xl mx-auto",children:s.bio})]}),t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-lg p-4 relative w-full max-w-lg",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",onClick:()=>r(!1),title:"Close",children:"‚úï"}),e.jsx(_e,{onClose:()=>r(!1)})]})}),e.jsx("div",{className:"w-full mt-8",children:e.jsx(Ne,{})})]}):e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 text-center",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:"No profile loaded."})})};function Ce({progress:s,className:t=""}){const r=Math.max(0,Math.min(100,s*100)),a=()=>r===0?"w-0":r>=100?"w-full":r>=75?"w-3/4":r>=50?"w-1/2":r>=25?"w-1/4":"w-1/12";return e.jsx("div",{className:`w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2 overflow-hidden ${t}`,children:e.jsx("div",{className:`bg-blue-600 h-2 rounded-full transition-all duration-300 ${a()}`})})}function Pe(){const[s,t]=m.useState({torrents:0,downloadSpeed:0,uploadSpeed:0,downloaded:0,uploaded:0,peers:0}),[r,a]=m.useState([]),[n,o]=m.useState([]),[i,c]=m.useState(!1);m.useEffect(()=>{let d;const g=(()=>{try{const b=$();c(!0);const p=b.onEvent(h=>{const y=new Date().toLocaleTimeString();switch(h.type){case"seeding-started":o(f=>[`[${y}] ‚úÖ Started seeding profile: ${h.profile.username}`,...f.slice(0,9)]);break;case"peer-connected":o(f=>[`[${y}] üîó Peer connected: ${h.peerId}`,...f.slice(0,9)]);break;case"upload-progress":Math.random()<.1&&o(f=>[`[${y}] ‚¨ÜÔ∏è Upload: ${l(h.uploadSpeed)}/s`,...f.slice(0,9)]);break;case"profile-downloaded":o(f=>[`[${y}] ‚¨áÔ∏è Downloaded profile: ${h.profile.username}`,...f.slice(0,9)]);break;case"download-progress":Math.random()<.1&&o(f=>[`[${y}] ‚¨áÔ∏è Progress: ${(h.progress*100).toFixed(1)}%`,...f.slice(0,9)]);break;case"error":o(f=>[`[${y}] ‚ùå Error: ${h.error}`,...f.slice(0,9)]);break}});return d=setInterval(()=>{t(b.getStats()),a(b.getActiveTorrents())},2e3),t(b.getStats()),a(b.getActiveTorrents()),p}catch(b){console.error("Failed to initialize torrent service:",b),c(!1),o(p=>[`Failed to initialize WebTorrent: ${b}`,...p.slice(0,9)])}})();return()=>{d&&clearInterval(d),g&&g()}},[]);const l=d=>{if(d===0)return"0 B";const x=1024,g=["B","KB","MB","GB"],b=Math.floor(Math.log(d)/Math.log(x));return parseFloat((d/Math.pow(x,b)).toFixed(1))+" "+g[b]};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"WebTorrent Client"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${i?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:i?"Connected":"Disconnected"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:s.torrents}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Active Torrents"})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:s.peers}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Connected Peers"})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-3",children:[e.jsxs("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:["‚¨ÜÔ∏è ",l(s.uploadSpeed),"/s"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Upload Speed"})]}),e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-3",children:[e.jsxs("div",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:["‚¨áÔ∏è ",l(s.downloadSpeed),"/s"]}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Download Speed"})]}),e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-lg font-bold text-indigo-600 dark:text-indigo-400",children:l(s.uploaded)}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Uploaded"})]}),e.jsxs("div",{className:"bg-pink-50 dark:bg-pink-900/20 rounded-lg p-3",children:[e.jsx("div",{className:"text-lg font-bold text-pink-600 dark:text-pink-400",children:l(s.downloaded)}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Downloaded"})]})]}),r.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Active Torrents"}),e.jsx("div",{className:"space-y-2",children:r.map(d=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white truncate",children:d.name||"Unnamed Torrent"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(d.progress*100).toFixed(1),"%"]})]}),e.jsx(Ce,{progress:d.progress,className:"mb-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:["Peers: ",d.numPeers]}),e.jsxs("span",{children:["‚¨ÜÔ∏è ",l(d.uploadSpeed),"/s ‚¨áÔ∏è ",l(d.downloadSpeed),"/s"]})]})]},d.infoHash))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Recent Activity"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 h-48 overflow-y-auto",children:n.length>0?e.jsx("div",{className:"space-y-1",children:n.map((d,x)=>e.jsx("div",{className:"text-sm font-mono text-gray-700 dark:text-gray-300",children:d},x))}):e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 mt-16",children:"No activity yet. Start seeding a profile to see torrent activity!"})})]})]})}class Q{static BACKUP_VERSION="1.0.0";static FILE_EXTENSION=".snartnet-backup";static async createBackup(t=!0){try{const a=await(await z()).getCurrentProfile();if(!a)throw new Error("No current profile to backup");const n=localStorage.getItem("snartnet_keypair");if(!n)throw new Error("No keypair found for backup");const o=localStorage.getItem(`profile-extended-${a.username}`);let i=null;if(t){const l=localStorage.getItem("snartnet-contacts");i=l?JSON.parse(l):[]}const c={version:this.BACKUP_VERSION,timestamp:new Date().toISOString(),profile:a,keypair:JSON.parse(n),extendedData:o?JSON.parse(o):null,contacts:i,metadata:{username:a.username,fingerprint:a.fingerprint||"unknown",backupId:this.generateBackupId()}};return console.log("Backup created successfully:",{username:c.metadata.username,timestamp:c.timestamp,includesContacts:!!c.contacts}),c}catch(r){throw console.error("Failed to create backup:",r),new Error(`Backup creation failed: ${r instanceof Error?r.message:"Unknown error"}`)}}static async downloadBackup(t=!0,r){try{const a=await this.createBackup(t);let n=a;r&&(n=await this.encryptBackup(a,r));const o=JSON.stringify(n,null,2),i=new Blob([o],{type:"application/json"}),c=URL.createObjectURL(i),l=document.createElement("a");l.href=c,l.download=`${a.metadata.username}_backup_${this.formatDateForFilename(a.timestamp)}${this.FILE_EXTENSION}`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(c),console.log("Backup downloaded successfully")}catch(a){throw console.error("Failed to download backup:",a),a}}static async restoreFromBackup(t,r){try{let a;r&&t.encrypted?a=await this.decryptBackup(t,r):a=t,this.validateBackup(a),console.log("Restoring backup:",{version:a.version,username:a.metadata.username,timestamp:a.timestamp}),localStorage.removeItem("snartnet_keypair"),localStorage.removeItem("snartnet_current_profile"),localStorage.removeItem("snartnet-contacts"),localStorage.setItem("snartnet_keypair",JSON.stringify(a.keypair)),localStorage.setItem("snartnet_current_profile",JSON.stringify({profile:a.profile,signature:a.keypair?.signature||"restored"})),a.extendedData&&a.metadata.username&&localStorage.setItem(`profile-extended-${a.metadata.username}`,JSON.stringify(a.extendedData)),a.contacts&&localStorage.setItem("snartnet-contacts",JSON.stringify(a.contacts)),console.log("Backup restored successfully"),window.location.reload()}catch(a){throw console.error("Failed to restore backup:",a),new Error(`Restore failed: ${a instanceof Error?a.message:"Unknown error"}`)}}static async restoreFromFile(t,r){try{if(!t.name.endsWith(this.FILE_EXTENSION)&&!t.name.endsWith(".json"))throw new Error("Invalid backup file format. Please select a .snartnet-backup or .json file.");const a=await this.readFileContent(t),n=JSON.parse(a);await this.restoreFromBackup(n,r)}catch(a){throw console.error("Failed to restore from file:",a),a}}static async encryptBackup(t,r){const a=JSON.stringify(t),n=btoa(unescape(encodeURIComponent(a)));return{encrypted:!0,version:t.version,data:n,hint:`Backup for ${t.metadata.username}`,timestamp:t.timestamp}}static async decryptBackup(t,r){try{const a=decodeURIComponent(escape(atob(t.data)));return JSON.parse(a)}catch{throw new Error("Invalid password or corrupted backup file")}}static validateBackup(t){if(!t||typeof t!="object")throw new Error("Invalid backup format");if(!t.version||!t.timestamp||!t.profile||!t.keypair)throw new Error("Incomplete backup data");if(!t.metadata||!t.metadata.username)throw new Error("Missing backup metadata");t.version!==this.BACKUP_VERSION&&console.warn("Backup version mismatch:",t.version,"vs",this.BACKUP_VERSION)}static readFileContent(t){return new Promise((r,a)=>{const n=new FileReader;n.onload=o=>{o.target?.result?r(o.target.result):a(new Error("Failed to read file"))},n.onerror=()=>{a(new Error("File reading error"))},n.readAsText(t)})}static generateBackupId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}static formatDateForFilename(t){return new Date(t).toISOString().split("T")[0].replace(/-/g,"")}static async getBackupInfo(t,r){try{const a=await this.readFileContent(t);let n=JSON.parse(a);return n.encrypted&&r&&(n=await this.decryptBackup(n,r)),{username:n.metadata?.username||"Unknown",timestamp:n.timestamp||"Unknown",version:n.version||"Unknown",hasContacts:Array.isArray(n.contacts)&&n.contacts.length>0,fingerprint:n.metadata?.fingerprint||"Unknown"}}catch(a){throw new Error("Failed to read backup info: "+(a instanceof Error?a.message:"Unknown error"))}}}const Ie=({onClose:s})=>{const{currentProfile:t}=D(),r=m.useRef(null),[a,n]=m.useState("backup"),[o,i]=m.useState(!0),[c,l]=m.useState(!1),[d,x]=m.useState(""),[g,b]=m.useState(!1),[p,h]=m.useState(""),[y,f]=m.useState(null),_=async()=>{if(!t){h("‚ùå No profile to backup");return}if(c&&!d.trim()){h("‚ùå Password is required");return}try{b(!0),h("üì¶ Creating backup..."),await Q.downloadBackup(o,c?d:void 0),h("‚úÖ Backup downloaded successfully!")}catch(v){console.error("Backup failed:",v),h(`‚ùå Backup failed: ${v instanceof Error?v.message:"Unknown error"}`)}finally{b(!1)}},w=async v=>{const A=v.target.files?.[0];if(A)try{b(!0),h("üìÑ Reading backup file...");const M=await Q.getBackupInfo(A,c?d:void 0);f(M),h("üìã Backup file loaded. Review info below and click Restore.")}catch(M){console.error("Failed to read backup:",M),h(`‚ùå Failed to read backup: ${M instanceof Error?M.message:"Unknown error"}`),f(null)}finally{b(!1)}},S=async()=>{const v=r.current?.files?.[0];if(!v){h("‚ùå Please select a backup file");return}if(c&&!d.trim()){h("‚ùå Password is required");return}if(confirm("‚ö†Ô∏è This will replace your current profile and data. Are you sure?"))try{b(!0),h("üîÑ Restoring backup..."),await Q.restoreFromFile(v,c?d:void 0),h("‚úÖ Backup restored successfully! Page will reload...")}catch(A){console.error("Restore failed:",A),h(`‚ùå Restore failed: ${A instanceof Error?A.message:"Unknown error"}`)}finally{b(!1)}},V=()=>{x(""),h(""),f(null),r.current&&(r.current.value="")};return e.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Profile Backup & Restore"}),s&&e.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:"‚úï"})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>{n("backup"),V()},className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${a==="backup"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,children:"üì¶ Backup"}),e.jsx("button",{onClick:()=>{n("restore"),V()},className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${a==="restore"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400"}`,children:"üîÑ Restore"})]})}),a==="backup"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"üìã What gets backed up:"}),e.jsxs("ul",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ Your profile information and cryptographic keys"}),e.jsx("li",{children:"‚Ä¢ Extended profile data (avatar, location, website)"}),e.jsx("li",{children:"‚Ä¢ Your contacts and relationships (optional)"}),e.jsx("li",{children:"‚Ä¢ All necessary data to restore your identity"})]})]}),t?e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Current Profile:"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:[e.jsx("strong",{children:"Username:"})," ",t.username,e.jsx("br",{}),e.jsx("strong",{children:"Display Name:"})," ",t.displayName||"Not set",e.jsx("br",{}),e.jsx("strong",{children:"Public Key:"})," ",t.publicKey?.slice(0,16)+"..."||"Unknown"]})]}):e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4",children:e.jsx("p",{className:"text-yellow-800 dark:text-yellow-200",children:"‚ö†Ô∏è No profile found to backup. Please create a profile first."})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:v=>i(v.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Include contacts and relationships in backup"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:v=>l(v.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Password protect backup (recommended)"})]}),c&&e.jsx("input",{type:"password",value:d,onChange:v=>x(v.target.value),placeholder:"Enter backup password",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),e.jsx("button",{onClick:_,disabled:g||!t,className:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors",children:g?"üì¶ Creating Backup...":"üíæ Download Backup"})]}),a==="restore"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-yellow-900 dark:text-yellow-100 mb-2",children:"‚ö†Ô∏è Important Warning:"}),e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"Restoring a backup will completely replace your current profile, keys, and data. Make sure to backup your current profile first if you want to keep it."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select Backup File:"}),e.jsx("input",{ref:r,type:"file",accept:".snartnet-backup,.json",onChange:w,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Accepts .snartnet-backup and .json files"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:v=>l(v.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Backup is password protected"})]}),c&&e.jsx("input",{type:"password",value:d,onChange:v=>x(v.target.value),placeholder:"Enter backup password",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),y&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Backup Information:"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",y.username]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Created:"})," ",new Date(y.timestamp).toLocaleString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Version:"})," ",y.version]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fingerprint:"})," ",y.fingerprint]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Includes Contacts:"})," ",y.hasContacts?"Yes":"No"]})]})]}),e.jsx("button",{onClick:S,disabled:g||!y,className:"w-full px-4 py-3 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors",children:g?"üîÑ Restoring...":"üîÑ Restore Backup"})]}),p&&e.jsx("div",{className:`mt-6 p-4 rounded-lg ${p.startsWith("‚úÖ")?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700":p.startsWith("‚ùå")?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700":p.startsWith("‚ö†Ô∏è")?"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700":"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700"}`,children:e.jsx("p",{className:`text-sm font-medium ${p.startsWith("‚úÖ")?"text-green-800 dark:text-green-200":p.startsWith("‚ùå")?"text-red-800 dark:text-red-200":p.startsWith("‚ö†Ô∏è")?"text-yellow-800 dark:text-yellow-200":"text-blue-800 dark:text-blue-200"}`,children:p})})]})},Ee=()=>{const{currentProfile:s,loading:t}=D(),[r,a]=m.useState(!1),[n,o]=m.useState(!1);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Profile Management"}),e.jsx("div",{className:"flex gap-2",children:s&&!r&&!n&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>o(!0),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors",children:"üíæ Backup & Restore"}),e.jsx("button",{onClick:()=>a(!0),className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors",children:"Create New Profile"})]})})]}),t&&e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading profile..."})]}),!t&&e.jsxs("div",{className:"space-y-8",children:[n&&e.jsx("div",{children:e.jsx(Ie,{onClose:()=>o(!1)})}),r&&!n&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Create New Profile"}),e.jsx("button",{onClick:()=>a(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"‚úï Cancel"})]}),e.jsx(re,{})]}),!n&&e.jsxs(e.Fragment,{children:[s?e.jsx("div",{children:!r&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Current Profile"}),e.jsx(Se,{})]})}):!r&&e.jsx(re,{}),e.jsx(Pe,{})]})]})]})},Te=()=>e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"Messages"}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Encrypted messaging features coming soon..."})})]});function ne({onProfileDownloaded:s}){const{currentProfile:t}=D(),[r,a]=m.useState(""),[n,o]=m.useState(!1),[i,c]=m.useState(""),[l,d]=m.useState(""),[x,g]=m.useState(!1),[b,p]=m.useState(!1),h=async()=>{if(!t){c("No profile to seed");return}try{g(!0),c("Starting to seed your profile...");const S=await(await z()).seedCurrentProfile();d(S),c("‚úÖ Profile is now seeding! Share the magnet link with friends."),p(!0)}catch(w){console.error("Error seeding profile:",w),c(`‚ùå Failed to seed profile: ${w}`)}finally{g(!1)}},y=async()=>{if(!r.trim()){c("Please enter a magnet link");return}if(!r.startsWith("magnet:?")){c("Invalid magnet link format");return}try{o(!0),c("Connecting to peers and downloading profile...");const S=await(await z()).downloadProfileFromMagnet(r.trim());S?(c(`‚úÖ Successfully downloaded profile: ${S.username}`),a(""),s&&s(S)):c("‚ùå Failed to download profile - no data received")}catch(w){console.error("Error downloading profile:",w),c(`‚ùå Download failed: ${w}`)}finally{o(!1)}},f=async()=>{if(l)try{await navigator.clipboard.writeText(l),c("‚úÖ Magnet link copied to clipboard!"),setTimeout(()=>c(""),3e3)}catch(w){console.error("Failed to copy magnet link:",w),c("Failed to copy magnet link")}},_=async()=>{if(l&&"share"in navigator)try{await navigator.share({title:`${t?.username}'s SnartNet Profile`,text:"Connect with me on SnartNet! Download my profile using this magnet link:",url:l})}catch(w){console.log("Share cancelled or failed:",w)}};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6",children:"Connect with Friends"}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Share Your Profile"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Start seeding your profile so friends can download it via P2P torrent network."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:h,disabled:!t||x,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors",children:x?"Starting Seed...":"üå± Start Seeding Profile"}),l&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:f,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"üìã Copy Magnet Link"}),"share"in navigator&&e.jsx("button",{onClick:_,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors",children:"üì± Share"})]})]}),l&&e.jsxs("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Your Magnet Link:"}),e.jsx("code",{className:"text-xs text-gray-600 dark:text-gray-400 break-all font-mono",children:l})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Download Friend's Profile"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Enter a magnet link from a friend to download their profile via P2P."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"magnet-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Magnet Link"}),e.jsx("textarea",{id:"magnet-input",value:r,onChange:w=>a(w.target.value),placeholder:"magnet:?xt=urn:btih:...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3})]}),e.jsx("button",{onClick:y,disabled:!r.trim()||n,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors",children:n?"‚¨áÔ∏è Downloading...":"‚¨áÔ∏è Download Profile"})]})]}),i&&e.jsx("div",{className:`p-4 rounded-lg ${i.includes("‚úÖ")?"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-200":i.includes("‚ùå")?"bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-200":"bg-blue-50 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200"}`,children:e.jsx("p",{className:"text-sm font-medium",children:i})}),b&&l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"üéâ Profile Successfully Seeding!"}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"‚úï"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Your profile is now available on the P2P network. Share this magnet link with friends:"}),e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3 mb-4",children:e.jsx("code",{className:"text-xs text-gray-600 dark:text-gray-400 break-all font-mono",children:l})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:f,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors",children:"üìã Copy"}),"share"in navigator&&e.jsx("button",{onClick:_,className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors",children:"üì± Share"})]})]})})]})}const Ue=s=>{switch(s){case"ring-of-trust":return{canMessage:!0,canSeeFullProfile:!0,canShareContacts:!0,canRecoverKeys:!0};case"friend":return{canMessage:!0,canSeeFullProfile:!0,canShareContacts:!0,canRecoverKeys:!1};case"acquaintance":return{canMessage:!0,canSeeFullProfile:!1,canShareContacts:!1,canRecoverKeys:!1};case"group-member":return{canMessage:!0,canSeeFullProfile:!1,canShareContacts:!1,canRecoverKeys:!1}}},Fe=(s,t)=>`contact_${btoa(s+t).slice(0,16)}`,oe=ae((s,t)=>({contacts:[],loadContacts:()=>{try{const r=localStorage.getItem("snartnet-contacts");if(r){const a=JSON.parse(r);s({contacts:a})}}catch(r){console.error("Failed to load contacts:",r)}},addContact:r=>{const a=t().contacts,n={...r,id:Fe(r.username,r.magnetUri),addedDate:new Date().toISOString(),permissions:Ue(r.relationship)},o=a.findIndex(i=>i.id===n.id);if(o>=0){const i=[...a];i[o]={...i[o],...n},s({contacts:i}),localStorage.setItem("snartnet-contacts",JSON.stringify(i))}else{const i=[...a,n];s({contacts:i}),localStorage.setItem("snartnet-contacts",JSON.stringify(i))}},removeContact:r=>{const n=t().contacts.filter(o=>o.id!==r);s({contacts:n}),localStorage.setItem("snartnet-contacts",JSON.stringify(n))},updateContact:(r,a)=>{const o=t().contacts.map(i=>i.id===r?{...i,...a}:i);s({contacts:o}),localStorage.setItem("snartnet-contacts",JSON.stringify(o))},getContactsByRelationship:r=>t().contacts.filter(a=>a.relationship===r),getContact:r=>t().contacts.find(a=>a.id===r)}));function Re(){const[s,t]=m.useState([]),{addContact:r,getContact:a}=oe();m.useEffect(()=>{const l=localStorage.getItem("snartnet-discovered-profiles");if(l)try{t(JSON.parse(l))}catch(d){console.error("Failed to load discovered profiles:",d)}},[]),m.useEffect(()=>{localStorage.setItem("snartnet-discovered-profiles",JSON.stringify(s))},[s]);const n=l=>{const d=s.findIndex(g=>g.publicKey===l.publicKey),x={id:l.publicKey.slice(0,8),username:l.username,displayName:l.displayName||l.username,bio:l.bio,publicKey:l.publicKey,avatar:l.avatar,downloadedAt:new Date().toISOString(),magnetURI:l.magnetURI};if(d>=0){const g=[...s];g[d]={...g[d],...x},t(g)}else t(g=>[x,...g])},o=l=>{t(d=>d.filter(x=>x.publicKey!==l))},i=(l,d="friend")=>{const x=`contact_${btoa(l.username+(l.magnetURI||"")).slice(0,16)}`;if(a(x)){alert(`${l.username} is already in your contacts!`);return}r({username:l.username,displayName:l.displayName,relationship:d,trustLevel:d==="friend"?7:5,magnetUri:l.magnetURI||"",avatar:l.avatar,notes:`Added from discovery on ${new Date().toLocaleDateString()}`}),alert(`${l.username} has been added to your ${d}s!`)},c=l=>new Date(l).toLocaleDateString()+" "+new Date(l).toLocaleTimeString();return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Discover Friends"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Share your profile and download friends' profiles using magnet links."})]}),e.jsx(ne,{onProfileDownloaded:n}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["Downloaded Friends (",s.length,")"]})}),s.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üë•"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No friends discovered yet"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Use the magnet link manager above to download friends' profiles from the P2P network."})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:s.map(l=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:border-blue-300 dark:hover:border-blue-500 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[l.avatar?e.jsx("img",{src:l.avatar,alt:`${l.username}'s avatar`,className:"w-10 h-10 rounded-full"}):e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-purple-500 rounded-full flex items-center justify-center text-white font-bold",children:l.username.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:l.displayName}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["@",l.username]})]})]}),e.jsx("button",{onClick:()=>o(l.publicKey),className:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 p-1",title:"Remove profile",children:"üóëÔ∏è"})]}),l.bio&&e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-3 line-clamp-2",children:l.bio}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-3",children:[e.jsxs("p",{children:["Downloaded: ",c(l.downloadedAt)]}),e.jsxs("p",{className:"font-mono",children:["ID: ",l.id]})]}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("button",{onClick:()=>i(l,"friend"),className:"flex-1 px-3 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg transition-colors",children:"‚ûï Add Friend"}),e.jsx("button",{onClick:()=>i(l,"acquaintance"),className:"flex-1 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors",children:"ü§ù Add Acquaintance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"flex-1 px-3 py-2 bg-gray-600 hover:bg-gray-700 text-white text-sm font-medium rounded-lg transition-colors",children:"üí¨ Message"}),e.jsx("button",{className:"flex-1 px-3 py-2 bg-gray-600 hover:bg-gray-700 text-white text-sm font-medium rounded-lg transition-colors",children:"üë§ View Profile"})]})]},l.publicKey))})]})]})}const Ae=()=>{const{loadContacts:s,addContact:t,removeContact:r,updateContact:a,getContactsByRelationship:n}=oe(),[o,i]=m.useState("friend"),[c,l]=m.useState(!1);m.useEffect(()=>{s()},[s]);const d=[{id:"friend",label:"Friends",icon:"üë•"},{id:"acquaintance",label:"Acquaintances",icon:"ü§ù"},{id:"ring-of-trust",label:"Ring of Trust",icon:"üõ°Ô∏è"},{id:"group-member",label:"Groups",icon:"üè†"}],x=n(o);return e.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[e.jsx("div",{className:"mb-10",children:e.jsx(ne,{})}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Contacts & Relationships"}),e.jsx("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Add Contact"})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:e.jsx("nav",{className:"flex space-x-8",children:d.map(g=>e.jsxs("button",{onClick:()=>i(g.id),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${o===g.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,children:[e.jsx("span",{className:"mr-2",children:g.icon}),g.label,e.jsx("span",{className:"ml-2 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-100 rounded-full px-2 py-1 text-xs",children:n(g.id).length})]},g.id))})}),c&&e.jsx(De,{onAdd:t,onCancel:()=>l(!1),defaultRelationship:o}),e.jsx("div",{className:"space-y-4",children:x.length===0?e.jsx(Be,{relationship:o,onAddContact:()=>l(!0)}):x.map(g=>e.jsx(Me,{contact:g,onUpdate:a,onRemove:r},g.id))})]})},De=({onAdd:s,onCancel:t,defaultRelationship:r})=>{const[a,n]=m.useState({username:"",displayName:"",relationship:r,trustLevel:5,magnetUri:"",notes:""}),o=i=>{i.preventDefault(),!(!a.username||!a.magnetUri)&&(s({username:a.username,displayName:a.displayName||a.username,relationship:a.relationship,trustLevel:a.trustLevel,magnetUri:a.magnetUri,notes:a.notes}),t())};return e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Add New Contact"}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Username *"}),e.jsx("input",{type:"text",value:a.username,onChange:i=>n(c=>({...c,username:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",required:!0,placeholder:"Enter username",title:"Username"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Display Name"}),e.jsx("input",{type:"text",value:a.displayName,onChange:i=>n(c=>({...c,displayName:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter display name (optional)",title:"Display Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Relationship Type"}),e.jsxs("select",{value:a.relationship,onChange:i=>n(c=>({...c,relationship:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",title:"Relationship Type",children:[e.jsx("option",{value:"friend",children:"Friend"}),e.jsx("option",{value:"acquaintance",children:"Acquaintance"}),e.jsx("option",{value:"ring-of-trust",children:"Ring of Trust"}),e.jsx("option",{value:"group-member",children:"Group Member"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Trust Level (1-10)"}),e.jsx("input",{type:"range",min:"1",max:"10",value:a.trustLevel,onChange:i=>n(c=>({...c,trustLevel:parseInt(i.target.value)})),className:"w-full",title:"Trust Level",placeholder:"Trust Level"}),e.jsx("div",{className:"text-center text-sm text-gray-500",children:a.trustLevel})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Magnet URI *"}),e.jsx("input",{type:"text",value:a.magnetUri,onChange:i=>n(c=>({...c,magnetUri:i.target.value})),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"magnet:?xt=urn:btih:...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes"}),e.jsx("textarea",{value:a.notes,onChange:i=>n(c=>({...c,notes:i.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Optional notes about this contact..."})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md",children:"Add Contact"}),e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-md",children:"Cancel"})]})]})]})},Me=({contact:s,onRemove:t})=>{const[r,a]=m.useState(!1),n=()=>{a(!r)},o=c=>{switch(c){case"ring-of-trust":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case"friend":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"acquaintance":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200";case"group-member":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"}},i=c=>new Date(c).toLocaleDateString();return e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center",children:s.avatar?e.jsx("img",{src:s.avatar,alt:s.displayName,className:"w-12 h-12 rounded-full object-cover"}):e.jsx("span",{className:"text-lg font-semibold text-gray-600 dark:text-gray-300",children:s.displayName.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:s.displayName}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["@",s.username]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${o(s.relationship)}`,children:s.relationship.replace("-"," ")}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Trust: ",s.trustLevel,"/10"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:n,className:"px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded",children:"Edit"}),e.jsx("button",{onClick:()=>t(s.id),className:"px-3 py-1 text-sm bg-red-100 hover:bg-red-200 dark:bg-red-900 dark:hover:bg-red-800 text-red-700 dark:text-red-300 rounded",children:"Remove"})]})]}),s.notes&&e.jsx("div",{className:"mt-3 p-2 bg-gray-50 dark:bg-gray-700 rounded text-sm text-gray-600 dark:text-gray-400",children:s.notes}),e.jsxs("div",{className:"mt-3 text-xs text-gray-500 dark:text-gray-400",children:["Added: ",i(s.addedDate),s.lastSeen&&` ‚Ä¢ Last seen: ${i(s.lastSeen)}`]})]})},Be=({relationship:s,onAddContact:t})=>{const r=a=>{switch(a){case"friend":return"No friends added yet. Start building your network!";case"acquaintance":return"No acquaintances yet. Add casual connections here.";case"ring-of-trust":return"No trusted contacts yet. Add your most trusted contacts for key recovery.";case"group-member":return"No group members yet. Add contacts from your groups."}};return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üì±"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:r(s)}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Add contacts to start building your decentralized social network."}),e.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg",children:"Add First Contact"})]})},Le=()=>e.jsx("nav",{className:"bg-white dark:bg-gray-800 shadow-sm",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsx(O,{to:"/",className:"text-xl font-bold text-gray-900 dark:text-white",children:"SnartNet"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx(O,{to:"/",className:"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white",children:"Home"}),e.jsx(O,{to:"/profile",className:"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white",children:"Profile"}),e.jsx(O,{to:"/discover",className:"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white",children:"Discover"}),e.jsx(O,{to:"/contacts",className:"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white",children:"Contacts"}),e.jsx(O,{to:"/messages",className:"text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white",children:"Messages"})]})]})})}),Oe=({children:s})=>e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(Le,{}),e.jsx("main",{className:"container mx-auto px-4 py-8",children:s})]});function $e(){const{setCurrentProfile:s,setLoading:t,setError:r}=D();m.useEffect(()=>{let a=!0;return(async()=>{try{t(!0),r(null),console.log("[useInitializeCore] Initializing core...");const o=await z();if(console.log("[useInitializeCore] Core initialized successfully"),o.hasProfile()){console.log("[useInitializeCore] Found existing profile, loading...");const i=await o.getCurrentProfile();i&&a&&(console.log("[useInitializeCore] Loaded existing profile:",i),s(i))}else console.log("[useInitializeCore] No existing profile found")}catch(o){if(console.error("[useInitializeCore] Failed to initialize core:",o),a){const i=o instanceof Error?o.message:"Failed to initialize";r(i)}}finally{a&&t(!1)}})(),()=>{a=!1}},[s,t,r])}function ze(){return $e(),e.jsx(le,{basename:"/net",children:e.jsx(Oe,{children:e.jsxs(ce,{children:[e.jsx(W,{path:"/",element:e.jsx(ke,{})}),e.jsx(W,{path:"/profile/:id?",element:e.jsx(Ee,{})}),e.jsx(W,{path:"/discover",element:e.jsx(Re,{})}),e.jsx(W,{path:"/contacts",element:e.jsx(Ae,{})}),e.jsx(W,{path:"/messages/:id?",element:e.jsx(Te,{})})]})})})}de(document.getElementById("root")).render(e.jsx(m.StrictMode,{children:e.jsx(ze,{})}));
//# sourceMappingURL=index-DyME5cJG.js.map
